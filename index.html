<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-R" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loading...</title>

  <style>
    /* ===== Enhanced Dark Candlestick Loader ===== */

    body {
      background: #000;
      margin: 0;
      padding: 0;
    }

    #loader {
      position: fixed;
      inset: 0;
      background: #000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 25px; /* Reduced gap for a tighter look */
      z-index: 9999;
    }

    .candles {
      display: block;
      position: relative;
      
      /* --- NEW: Grid & Chart Window --- */
      width: 400px;  /* (20w + 18g) * 10 = 380px + 40px padding */
      height: 500px; /* 300px for chart + 40px padding */
      padding: 20px;
      box-sizing: border-box;
      border: 1px solid #444;
      background-color: #000;
      background-image: 
        repeating-linear-gradient(
          to right,
          #222 0,
          #222 1px,
          transparent 1px,
          transparent 40px
        ),
        repeating-linear-gradient(
          to bottom,
          #222 0,
          #222 1px,
          transparent 1px,
          transparent 40px
        );
      background-size: 40px 40px; /* Size of one grid square */
    }

    .candle {
      width: 20px;
      position: absolute; 
      transform-origin: bottom center;
      opacity: 0;
      transform: translateY(20px) scaleY(0.6);
      animation: appearRise 1.4s forwards ease-out;
      animation-delay: var(--delay);
    }

    .green {
      background: #00ff87;
    }

    .red {
      background: #ff4f4f;
    }

    .candle::before {
      content: "";
      position: absolute;
      left: 50%;
      width: 2px;
      background: #bbb;
      top: 0;
      transform: translate(-50%, -100%); 
      height: var(--upper-wick, 20px);
    }

    .candle::after {
      content: "";
      position: absolute;
      left: 50%;
      width: 2px;
      background: #bbb;
      bottom: 0;
      transform: translate(-50%, 100%); 
      height: var(--lower-wick, 22px);
    }

    /* Staggered animation delays */
    .candles .candle:nth-child(1) { --delay: 0s; }
    .candles .candle:nth-child(2) { --delay: 1s; }
    .candles .candle:nth-child(3) { --delay: 2s; }
    .candles .candle:nth-child(4) { --delay: 3s; }
    .candles .candle:nth-child(5) { --delay: 4s; }
    .candles .candle:nth-child(6) { --delay: 5s; }
    .candles .candle:nth-child(7) { --delay: 6s; }
    .candles .candle:nth-child(8) { --delay: 7s; }
    .candles .candle:nth-child(9) { --delay: 8s; }
    .candles .candle:nth-child(10){ --delay: 9s; }

    @keyframes appearRise {
      0%   { opacity: 0; transform: translateY(20px) scaleY(0.6); }
      60%  { opacity: 1; transform: translateY(-4px) scaleY(1.25); }
      100% { opacity: 1; transform: translateY(0) scaleY(1); }
    }

    /* --- NEW: Loading Bar --- */
    .loader-bar-container {
      width: 420px; /* Match the chart width */
      height: 10px;
      background-color: #333;
      border-radius: 5px;
      overflow: hidden; 
    }

    .loader-bar-fill {
      height: 100%;
      width: 0%;
      background-color: #00ff87; /* Use the "green" from the candles */
      border-radius: 5px;
      /* Animation matches the 15.5s JS redirect timer */
      animation: fillBar 15.5s linear forwards; 
    }

    @keyframes fillBar {
      from { width: 0%; }
      to   { width: 100%; }
    }

  </style>

  <script>
    // Redirect logic (no change)
    setTimeout(() => {
      window.location.href = "home.html";
    }, 10000);

    // Positions the candles
    document.addEventListener("DOMContentLoaded", () => {
      const candles = document.querySelectorAll('.candle');
      
      // UPDATED: Start at 20px to account for the grid padding
      let currentClosePriceY = 20; 
      const candleWidth = 20;
      const candleGap = 18;

      candles.forEach((candle, index) => {
        const height = parseInt(candle.style.height, 10);
        const isGreen = candle.classList.contains('green');

        // 1. Calculate and set Horizontal (X) position
        // UPDATED: Start at 20px to account for grid padding
        const xPosition = 20 + index * (candleWidth + candleGap);
        candle.style.left = `${xPosition}px`;

        // 2. Calculate and set Vertical (Y) position
        if (isGreen) {
          candle.style.bottom = `${currentClosePriceY}px`;
          currentClosePriceY = currentClosePriceY + height;
        } else {
          
          // ***** THIS IS THE FIX *****
          // Changed currentClosePriceV to currentClosePriceY
          candle.style.bottom = `${currentClosePriceY - height}px`; 
          
          currentClosePriceY = currentClosePriceY - height;
        }
      });
    });
  </script>
  <script>
    document.addEventListener("mousemove", (e) => {
      const cursor = document.getElementById("cursor");
      cursor.style.left = e.clientX + "px";
      cursor.style.top = e.clientY + "px";
    });
  </script>
</head>

<body>
  <div id="cursor"></div>
  <div id="loader">
    <div class="candles">
      <div class="candle green" style="height:40px; --upper-wick:15px; --lower-wick:10px;"></div>
      <div class="candle green" style="height:60px; --upper-wick:10px; --lower-wick:10px;"></div>
      <div class="candle red"   style="height:35px; --upper-wick:20px; --lower-wick:5px;"></div>
      <div class="candle green" style="height:25px; --upper-wick:5px;  --lower-wick:35px;"></div>
      <div class="candle green" style="height:70px; --upper-wick:10px; --lower-wick:10px;"></div>
      <div class="candle green" style="height:80px; --upper-wick:15px; --lower-wick:15px;"></div>
      <div class="candle red"   style="height:45px; --upper-wick:20px; --lower-wick:20px;"></div>
      <div class="candle green" style="height:90px; --upper-wick:20px; --lower-wick:10px;"></div>
      <div class="candle green" style="height:110px; --upper-wick:15px; --lower-wick:15px;"></div>
      <div class="candle red"   style="height:50px; --upper-wick:25px; --lower-wick:25px;"></div>
    </div>
    
    <div class="loader-bar-container">
      <div class="loader-bar-fill"></div>
    </div>
  </div>
</body>
</html>